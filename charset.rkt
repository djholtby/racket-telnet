#lang racket/base

(provide mib->symbol encoding->mib encoding->symbol)

;; These are the official names + aliases for iConv
;; On Windows typically about half of these will work?
;; On Linux it should be 100% working

(define charset-name-table 
  '#hasheqv((3 . ASCII)
            (4 . LATIN1)
            (5 . LATIN2)
            (6 . LATIN3)
            (7 . LATIN4)
            (8 . CYRILLIC)
            (9 . ARABIC)
            (10 . GREEK)
            (11 . HEBREW)
            (12 . LATIN5)
            (13 . LATIN6)
            (17 . SHIFT-JIS)
            (18 . EUC-JP)
            (20 . BS_4730)
            (21 . SEN_850200_C)
            (22 . IT)
            (23 . ES)
            (24 . DIN_66003)
            (25 . NS_4551-1)
            (26 . NF_Z_62-010)
            (31 . NATS-SEFI)
            (33 . NATS-DANO)
            (34 . ISO-IR-92)
            (35 . SEN_850200_B)
            (37 . ISO-2022-KR)
            (38 . EUC-KR)
            (39 . ISO-2022-JP)
            (40 . ISO-2022-JP-2)
            (42 . JIS_C6220-1969-RO)
            (43 . PT)
            (44 . GREEK7-OLD)
            (45 . LATIN-GREEK)
            (46 . NF_Z_62-010_1973)
            (47 . LATIN-GREEK-1)
            (48 . ISO_5427)
            (51 . INIS)
            (52 . INIS-8)
            (53 . INIS-CYRILLIC)
            (54 . ISO_5427:1981)
            (55 . ISO_5428:1980)
            (56 . GB_1988-80)
            (58 . NS_4551-2)
            (60 . PT2)
            (61 . ES2)
            (62 . MSZ_7795.3)
            (64 . GREEK7)
            (65 . ASMO_449)
            (66 . ISO-IR-90)
            (68 . JIS_C6229-1984-B)
            (73 . ISO_2033-1983)
            (74 . ANSI_X3.110-1983)
            (76 . T.61-8BIT)
            (77 . ECMA-CYRILLIC)
            (78 . CSA_Z243.4-1985-1)
            (79 . CSA_Z243.4-1985-2)
            (86 . CSN_369103)
            (87 . JUS_I.B1.002)
            (88 . IEC_P27-1)
            (91 . GREEK-CCITT)
            (92 . NC_NC00-10:81)
            (94 . GOST_19768-74)
            (96 . ISO_10367-BOX)
            (99 . DS_2089)
            (102 . KSC5636)
            (104 . ISO-2022-CN)
            (105 . ISO-2022-CN-EXT)
            (106 . UTF-8)
            (109 . ISO-8859-13)
            (110 . ISO-8859-14)
            (111 . ISO-8859-15)
            (112 . ISO-8859-16)
            (113 . GBK)
            (114 . GB18030)
            (118 . ISO_11548-1)
            (119 . RK1048)
            (1000 . CSUNICODE)
            (1001 . CSUCS4)
            (1003 . ISO-10646)
            (1012 . UTF-7)
            (1013 . UTF-16BE)
            (1014 . UTF-16LE)
            (1015 . UTF-16)
            (1017 . UTF-32)
            (1018 . UTF-32BE)
            (1019 . UTF-32LE)
            (2004 . HP-ROMAN8)
            (2008 . DEC-MCS)
            (2009 . IBM850)
            (2010 . IBM852)
            (2011 . IBM437)
            (2013 . IBM862)
            (2024 . WINDOWS-31J)
            (2025 . GB2312)
            (2026 . BIG5)
            (2027 . MACINTOSH)
            (2028 . IBM037)
            (2029 . IBM038)
            (2030 . IBM273)
            (2031 . IBM274)
            (2032 . IBM275)
            (2033 . IBM277)
            (2034 . IBM278)
            (2035 . IBM280)
            (2036 . IBM281)
            (2037 . IBM284)
            (2038 . IBM285)
            (2039 . IBM290)
            (2040 . IBM297)
            (2041 . IBM420)
            (2042 . IBM423)
            (2043 . IBM424)
            (2044 . IBM500)
            (2045 . IBM851)
            (2046 . IBM855)
            (2047 . IBM857)
            (2048 . IBM860)
            (2049 . IBM861)
            (2050 . IBM863)
            (2051 . IBM864)
            (2052 . IBM865)
            (2053 . IBM868)
            (2054 . IBM869)
            (2055 . IBM870)
            (2056 . IBM871)
            (2057 . IBM880)
            (2058 . IBM891)
            (2059 . IBM903)
            (2060 . IBM904)
            (2061 . IBM905)
            (2062 . IBM918)
            (2063 . IBM1026)
            (2064 . EBCDIC-AT-DE)
            (2065 . EBCDIC-AT-DE-A)
            (2066 . EBCDIC-CA-FR)
            (2067 . EBCDIC-DK-NO)
            (2068 . EBCDIC-DK-NO-A)
            (2069 . EBCDIC-FI-SE)
            (2070 . EBCDIC-FI-SE-A)
            (2071 . EBCDIC-FR)
            (2072 . EBCDIC-IT)
            (2073 . EBCDIC-PT)
            (2074 . EBCDIC-ES)
            (2075 . EBCDIC-ES-A)
            (2076 . EBCDIC-ES-S)
            (2077 . EBCDIC-UK)
            (2078 . EBCDIC-US)
            (2082 . VISCII)
            (2084 . KOI8-R)
            (2086 . IBM866)
            (2087 . IBM775)
            (2088 . KOI8-U)
            (2101 . BIG5-HKSCS)
            (2102 . IBM1047)
            (2103 . PT154)
            (2106 . BRF)
            (2107 . TSCII)
            (2109 . WINDOWS-874)
            (2250 . WINDOWS-1250)
            (2251 . WINDOWS-1251)
            (2252 . WINDOWS-1252)
            (2253 . WINDOWS-1253)
            (2254 . WINDOWS-1254)
            (2255 . WINDOWS-1255)
            (2256 . WINDOWS-1256)
            (2257 . WINDOWS-1257)
            (2258 . WINDOWS-1258)))

(define charset-value-table
  '#hasheq((ANSI_X3.110-1983 . 74)
         (ANSI_X3.4-1968 . 3)
         (ANSI_X3.4-1986 . 3)
         (ARABIC . 9)
         (ARABIC7 . 65)
         (ASCII . 3)
         (ASMO-708 . 9)
         (ASMO_449 . 65)
         (BIG-5 . 2026)
         (BIG5 . 2026)
         (BIG5-HKSCS . 2101)
         (BIG5HKSCS . 2101)
         (BRF . 2106)
         (BS_4730 . 20)
         (CA . 78)
         (CN . 56)
         (CP-AR . 2053)
         (CP-GR . 2054)
         (CP-IS . 2049)
         (CP037 . 2028)
         (CP038 . 2029)
         (CP1026 . 2063)
         (CP154 . 2103)
         (CP273 . 2030)
         (CP274 . 2031)
         (CP275 . 2032)
         (CP278 . 2034)
         (CP280 . 2035)
         (CP281 . 2036)
         (CP284 . 2037)
         (CP285 . 2038)
         (CP290 . 2039)
         (CP297 . 2040)
         (CP367 . 3)
         (CP420 . 2041)
         (CP423 . 2042)
         (CP424 . 2043)
         (CP437 . 2011)
         (CP500 . 2044)
         (CP775 . 2087)
         (CP819 . 4)
         (CP850 . 2009)
         (CP851 . 2045)
         (CP852 . 2010)
         (CP855 . 2046)
         (CP857 . 2047)
         (CP860 . 2048)
         (CP861 . 2049)
         (CP862 . 2013)
         (CP863 . 2050)
         (CP864 . 2051)
         (CP865 . 2052)
         (CP866 . 2086)
         (CP868 . 2053)
         (CP869 . 2054)
         (CP870 . 2055)
         (CP871 . 2056)
         (CP880 . 2057)
         (CP891 . 2058)
         (CP903 . 2059)
         (CP904 . 2060)
         (CP905 . 2061)
         (CP918 . 2062)
         (CP936 . 113)
         (CSA7-1 . 78)
         (CSA7-2 . 79)
         (CSA71 . 78)
         (CSA72 . 79)
         (CSASCII . 3)
         (CSA_T500-1983 . 74)
         (CSA_Z243.4-1985-1 . 78)
         (CSA_Z243.4-1985-2 . 79)
         (CSA_Z243.419851 . 78)
         (CSA_Z243.419852 . 79)
         (CSBIG5 . 2026)
         (CSBIG5HKSCS . 2101)
         (CSBRF . 2106)
         (CSDECMCS . 2008)
         (CSEBCDICATDEA . 2065)
         (CSEBCDICCAFR . 2066)
         (CSEBCDICDKNO . 2067)
         (CSEBCDICDKNOA . 2068)
         (CSEBCDICES . 2074)
         (CSEBCDICESA . 2075)
         (CSEBCDICESS . 2076)
         (CSEBCDICFISE . 2069)
         (CSEBCDICFISEA . 2070)
         (CSEBCDICFR . 2071)
         (CSEBCDICIT . 2072)
         (CSEBCDICPT . 2073)
         (CSEBCDICUK . 2077)
         (CSEBCDICUS . 2078)
         (CSEUCKR . 38)
         (CSEUCPKDFMTJAPANESE . 18)
         (CSGB18030 . 114)
         (CSGB2312 . 2025)
         (CSGBK . 113)
         (CSHPROMAN8 . 2004)
         (CSIBBM904 . 2060)
         (CSIBM037 . 2028)
         (CSIBM038 . 2029)
         (CSIBM1026 . 2063)
         (CSIBM1047 . 2102)
         (CSIBM273 . 2030)
         (CSIBM274 . 2031)
         (CSIBM275 . 2032)
         (CSIBM277 . 2033)
         (CSIBM278 . 2034)
         (CSIBM280 . 2035)
         (CSIBM281 . 2036)
         (CSIBM284 . 2037)
         (CSIBM285 . 2038)
         (CSIBM290 . 2039)
         (CSIBM297 . 2040)
         (CSIBM420 . 2041)
         (CSIBM423 . 2042)
         (CSIBM424 . 2043)
         (CSIBM500 . 2044)
         (CSIBM851 . 2045)
         (CSIBM855 . 2046)
         (CSIBM857 . 2047)
         (CSIBM860 . 2048)
         (CSIBM861 . 2049)
         (CSIBM863 . 2050)
         (CSIBM864 . 2051)
         (CSIBM865 . 2052)
         (CSIBM866 . 2086)
         (CSIBM868 . 2053)
         (CSIBM869 . 2054)
         (CSIBM870 . 2055)
         (CSIBM871 . 2056)
         (CSIBM880 . 2057)
         (CSIBM891 . 2058)
         (CSIBM903 . 2059)
         (CSIBM905 . 2061)
         (CSIBM918 . 2062)
         (CSIBMEBCDICATDE . 2064)
         (CSISO10367BOX . 96)
         (CSISO103T618BIT . 76)
         (CSISO10SWEDISH . 35)
         (CSISO111ECMACYRILLIC . 77)
         (CSISO115481 . 118)
         (CSISO11SWEDISHFORNAMES . 21)
         (CSISO121CANADIAN1 . 78)
         (CSISO122CANADIAN2 . 79)
         (CSISO139CSN369103 . 86)
         (CSISO141JUSIB1002 . 87)
         (CSISO143IECP271 . 88)
         (CSISO14JISC6220RO . 42)
         (CSISO150 . 91)
         (CSISO150GREEKCCITT . 91)
         (CSISO151CUBA . 92)
         (CSISO153GOST1976874 . 94)
         (CSISO15ITALIAN . 22)
         (CSISO16PORTUGUESE . 43)
         (CSISO17SPANISH . 23)
         (CSISO18GREEK7OLD . 44)
         (CSISO19LATINGREEK . 45)
         (CSISO2022CN . 104)
         (CSISO2022CNEXT . 105)
         (CSISO2022JP . 39)
         (CSISO2022JP2 . 40)
         (CSISO2022KR . 37)
         (CSISO2033 . 73)
         (CSISO21GERMAN . 24)
         (CSISO25FRENCH . 46)
         (CSISO27LATINGREEK1 . 47)
         (CSISO49INIS . 51)
         (CSISO4UNITEDKINGDOM . 20)
         (CSISO50INIS8 . 52)
         (CSISO51INISCYRILLIC . 53)
         (CSISO54271981 . 54)
         (CSISO5427CYRILLIC . 48)
         (CSISO5428GREEK . 55)
         (CSISO57GB1988 . 56)
         (CSISO60DANISHNORWEGIAN . 25)
         (CSISO60NORWEGIAN1 . 25)
         (CSISO61NORWEGIAN2 . 58)
         (CSISO646DANISH . 99)
         (CSISO69FRENCH . 26)
         (CSISO84PORTUGUESE2 . 60)
         (CSISO85SPANISH2 . 61)
         (CSISO86HUNGARIAN . 62)
         (CSISO885913 . 109)
         (CSISO885914 . 110)
         (CSISO885915 . 111)
         (CSISO885916 . 112)
         (CSISO88GREEK7 . 64)
         (CSISO89ASMO449 . 65)
         (CSISO90 . 66)
         (CSISO92JISC62991984B . 68)
         (CSISO99NAPLPS . 74)
         (CSISOLATIN1 . 4)
         (CSISOLATIN2 . 5)
         (CSISOLATIN3 . 6)
         (CSISOLATIN4 . 7)
         (CSISOLATIN5 . 12)
         (CSISOLATIN6 . 13)
         (CSISOLATINARABIC . 9)
         (CSISOLATINCYRILLIC . 8)
         (CSISOLATINGREEK . 10)
         (CSISOLATINHEBREW . 11)
         (CSKOI8R . 2084)
         (CSKOI8U . 2088)
         (CSKSC5636 . 102)
         (CSKZ1048 . 119)
         (CSMACINTOSH . 2027)
         (CSNATSDANO . 33)
         (CSNATSDANOADD . 34)
         (CSNATSSEFI . 31)
         (CSN_369103 . 86)
         (CSPC775BALTIC . 2087)
         (CSPC850MULTILINGUAL . 2009)
         (CSPC862LATINHEBREW . 2013)
         (CSPC8CODEPAGE437 . 2011)
         (CSPCP852 . 2010)
         (CSPTCP154 . 2103)
         (CSSHIFTJIS . 17)
         (CSTSCII . 2107)
         (CSUCS4 . 1001)
         (CSUNICODE . 1000)
         (CSUNICODELATIN1 . 1003)
         (CSUTF16 . 1015)
         (CSUTF16BE . 1013)
         (CSUTF16LE . 1014)
         (CSUTF32 . 1017)
         (CSUTF32BE . 1018)
         (CSUTF32LE . 1019)
         (CSUTF7 . 1012)
         (CSUTF8 . 106)
         (CSVISCII . 2082)
         (CSWINDOWS1250 . 2250)
         (CSWINDOWS1251 . 2251)
         (CSWINDOWS1252 . 2252)
         (CSWINDOWS1253 . 2253)
         (CSWINDOWS1254 . 2254)
         (CSWINDOWS1255 . 2255)
         (CSWINDOWS1256 . 2256)
         (CSWINDOWS1257 . 2257)
         (CSWINDOWS1258 . 2258)
         (CSWINDOWS31J . 2024)
         (CSWINDOWS874 . 2109)
         (CUBA . 92)
         (CYRILLIC . 8)
         (CYRILLIC-ASIAN . 2103)
         (DE . 24)
         (DEC . 2008)
         (DEC-MCS . 2008)
         (DECMCS . 2008)
         (DIN_66003 . 24)
         (DK . 99)
         (DS2089 . 99)
         (DS_2089 . 99)
         (E13B . 73)
         (EBCDIC-AT-DE . 2064)
         (EBCDIC-AT-DE-A . 2065)
         (EBCDIC-BE . 2031)
         (EBCDIC-BR . 2032)
         (EBCDIC-CA-FR . 2066)
         (EBCDIC-CP-AR1 . 2041)
         (EBCDIC-CP-AR2 . 2062)
         (EBCDIC-CP-BE . 2044)
         (EBCDIC-CP-CA . 2028)
         (EBCDIC-CP-CH . 2044)
         (EBCDIC-CP-DK . 2033)
         (EBCDIC-CP-ES . 2037)
         (EBCDIC-CP-FI . 2034)
         (EBCDIC-CP-FR . 2040)
         (EBCDIC-CP-GB . 2038)
         (EBCDIC-CP-GR . 2042)
         (EBCDIC-CP-HE . 2043)
         (EBCDIC-CP-IS . 2056)
         (EBCDIC-CP-IT . 2035)
         (EBCDIC-CP-NL . 2028)
         (EBCDIC-CP-NO . 2033)
         (EBCDIC-CP-ROECE . 2055)
         (EBCDIC-CP-SE . 2034)
         (EBCDIC-CP-TR . 2061)
         (EBCDIC-CP-US . 2028)
         (EBCDIC-CP-WT . 2028)
         (EBCDIC-CP-YU . 2055)
         (EBCDIC-CYRILLIC . 2057)
         (EBCDIC-DK-NO . 2067)
         (EBCDIC-DK-NO-A . 2068)
         (EBCDIC-ES . 2074)
         (EBCDIC-ES-A . 2075)
         (EBCDIC-ES-S . 2076)
         (EBCDIC-FI-SE . 2069)
         (EBCDIC-FI-SE-A . 2070)
         (EBCDIC-FR . 2071)
         (EBCDIC-INT . 2029)
         (EBCDIC-IT . 2072)
         (EBCDIC-JP-E . 2036)
         (EBCDIC-JP-KANA . 2039)
         (EBCDIC-PT . 2073)
         (EBCDIC-UK . 2077)
         (EBCDIC-US . 2078)
         (EBCDICATDE . 2064)
         (EBCDICATDEA . 2065)
         (EBCDICCAFR . 2066)
         (EBCDICDKNO . 2067)
         (EBCDICDKNOA . 2068)
         (EBCDICES . 2074)
         (EBCDICESA . 2075)
         (EBCDICESS . 2076)
         (EBCDICFISE . 2069)
         (EBCDICFISEA . 2070)
         (EBCDICFR . 2071)
         (EBCDICIT . 2072)
         (EBCDICPT . 2073)
         (EBCDICUK . 2077)
         (EBCDICUS . 2078)
         (ECMA-114 . 9)
         (ECMA-118 . 10)
         (ECMA-CYRILLIC . 77)
         (ECMACYRILLIC . 77)
         (ELOT_928 . 10)
         (ES . 23)
         (ES2 . 61)
         (EUC-JP . 18)
         (EUC-KR . 38)
         (EUCKR . 38)
         (FI . 35)
         (FR . 26)
         (GB . 20)
         (GB18030 . 114)
         (GB2312 . 2025)
         (GBK . 113)
         (GB_1988-80 . 56)
         (GB_198880 . 56)
         (GOST_19768-74 . 94)
         (GOST_1976874 . 94)
         (GREEK . 10)
         (GREEK-CCITT . 91)
         (GREEK7 . 64)
         (GREEK7-OLD . 44)
         (GREEK7OLD . 44)
         (GREEK8 . 10)
         (GREEKCCITT . 91)
         (HEBREW . 11)
         (HP-ROMAN8 . 2004)
         (HPROMAN8 . 2004)
         (HU . 62)
         (IBM-1047 . 2102)
         (IBM037 . 2028)
         (IBM038 . 2029)
         (IBM1026 . 2063)
         (IBM1047 . 2102)
         (IBM273 . 2030)
         (IBM274 . 2031)
         (IBM275 . 2032)
         (IBM277 . 2033)
         (IBM278 . 2034)
         (IBM280 . 2035)
         (IBM281 . 2036)
         (IBM284 . 2037)
         (IBM285 . 2038)
         (IBM290 . 2039)
         (IBM297 . 2040)
         (IBM367 . 3)
         (IBM420 . 2041)
         (IBM423 . 2042)
         (IBM424 . 2043)
         (IBM437 . 2011)
         (IBM500 . 2044)
         (IBM775 . 2087)
         (IBM819 . 4)
         (IBM850 . 2009)
         (IBM851 . 2045)
         (IBM852 . 2010)
         (IBM855 . 2046)
         (IBM857 . 2047)
         (IBM860 . 2048)
         (IBM861 . 2049)
         (IBM862 . 2013)
         (IBM863 . 2050)
         (IBM864 . 2051)
         (IBM865 . 2052)
         (IBM866 . 2086)
         (IBM868 . 2053)
         (IBM869 . 2054)
         (IBM870 . 2055)
         (IBM871 . 2056)
         (IBM880 . 2057)
         (IBM891 . 2058)
         (IBM903 . 2059)
         (IBM904 . 2060)
         (IBM905 . 2061)
         (IBM918 . 2062)
         (IEC_P27-1 . 88)
         (IEC_P271 . 88)
         (INIS . 51)
         (INIS-8 . 52)
         (INIS-CYRILLIC . 53)
         (INIS8 . 52)
         (INISCYRILLIC . 53)
         (ISO-10646 . 1003)
         (ISO-10646-UCS-2 . 1000)
         (ISO-10646-UCS-4 . 1001)
         (ISO-10646-UNICODE-LATIN1 . 1003)
         (ISO-11548-1 . 118)
         (ISO-2022-CN . 104)
         (ISO-2022-CN-EXT . 105)
         (ISO-2022-JP . 39)
         (ISO-2022-JP-2 . 40)
         (ISO-2022-KR . 37)
         (ISO-8859-1 . 4)
         (ISO-8859-10 . 13)
         (ISO-8859-13 . 109)
         (ISO-8859-14 . 110)
         (ISO-8859-15 . 111)
         (ISO-8859-16 . 112)
         (ISO-8859-2 . 5)
         (ISO-8859-3 . 6)
         (ISO-8859-4 . 7)
         (ISO-8859-5 . 8)
         (ISO-8859-6 . 9)
         (ISO-8859-7 . 10)
         (ISO-8859-8 . 11)
         (ISO-8859-9 . 12)
         (ISO-CELTIC . 110)
         (ISO-IR-10 . 35)
         (ISO-IR-100 . 4)
         (ISO-IR-101 . 5)
         (ISO-IR-103 . 76)
         (ISO-IR-109 . 6)
         (ISO-IR-11 . 21)
         (ISO-IR-110 . 7)
         (ISO-IR-111 . 77)
         (ISO-IR-121 . 78)
         (ISO-IR-122 . 79)
         (ISO-IR-126 . 10)
         (ISO-IR-127 . 9)
         (ISO-IR-138 . 11)
         (ISO-IR-139 . 86)
         (ISO-IR-14 . 42)
         (ISO-IR-141 . 87)
         (ISO-IR-143 . 88)
         (ISO-IR-144 . 8)
         (ISO-IR-148 . 12)
         (ISO-IR-15 . 22)
         (ISO-IR-150 . 91)
         (ISO-IR-151 . 92)
         (ISO-IR-153 . 94)
         (ISO-IR-155 . 96)
         (ISO-IR-157 . 13)
         (ISO-IR-16 . 43)
         (ISO-IR-17 . 23)
         (ISO-IR-18 . 44)
         (ISO-IR-19 . 45)
         (ISO-IR-199 . 110)
         (ISO-IR-21 . 24)
         (ISO-IR-226 . 112)
         (ISO-IR-25 . 46)
         (ISO-IR-27 . 47)
         (ISO-IR-37 . 48)
         (ISO-IR-4 . 20)
         (ISO-IR-49 . 51)
         (ISO-IR-50 . 52)
         (ISO-IR-51 . 53)
         (ISO-IR-54 . 54)
         (ISO-IR-55 . 55)
         (ISO-IR-57 . 56)
         (ISO-IR-60 . 25)
         (ISO-IR-61 . 58)
         (ISO-IR-69 . 26)
         (ISO-IR-8-1 . 31)
         (ISO-IR-84 . 60)
         (ISO-IR-85 . 61)
         (ISO-IR-86 . 62)
         (ISO-IR-88 . 64)
         (ISO-IR-89 . 65)
         (ISO-IR-9-1 . 33)
         (ISO-IR-9-2 . 34)
         (ISO-IR-90 . 66)
         (ISO-IR-92 . 34)
         (ISO-IR-98 . 73)
         (ISO-IR-99 . 74)
         (ISO2022CN . 104)
         (ISO2022CNEXT . 105)
         (ISO2022JP . 39)
         (ISO2022JP2 . 40)
         (ISO2022KR . 37)
         (ISO5427CYRILLIC1981 . 54)
         (ISO646-CA . 78)
         (ISO646-CA2 . 79)
         (ISO646-CN . 56)
         (ISO646-CU . 92)
         (ISO646-DE . 24)
         (ISO646-DK . 99)
         (ISO646-ES . 23)
         (ISO646-ES2 . 61)
         (ISO646-FI . 35)
         (ISO646-FR . 26)
         (ISO646-FR1 . 46)
         (ISO646-GB . 20)
         (ISO646-HU . 62)
         (ISO646-IT . 22)
         (ISO646-JP . 42)
         (ISO646-JP-OCR-B . 68)
         (ISO646-KR . 102)
         (ISO646-NO . 25)
         (ISO646-NO2 . 58)
         (ISO646-PT . 43)
         (ISO646-PT2 . 60)
         (ISO646-SE . 35)
         (ISO646-SE2 . 21)
         (ISO646-US . 3)
         (ISO646-YU . 87)
         (ISO8859-10 . 13)
         (ISO8859-13 . 109)
         (ISO885910 . 13)
         (ISO885913 . 109)
         (ISO_10367-BOX . 96)
         (ISO_10367BOX . 96)
         (ISO_11548-1 . 118)
         (ISO_2033 . 73)
         (ISO_2033-1983 . 73)
         (ISO_5427 . 48)
         (ISO_5427:1981 . 54)
         (ISO_5428:1980 . 55)
         (ISO_646.IRV:1991 . 3)
         (ISO_8859-1 . 4)
         (ISO_8859-10 . 13)
         (ISO_8859-10:1992 . 13)
         (ISO_8859-14 . 110)
         (ISO_8859-14:1998 . 110)
         (ISO_8859-15 . 111)
         (ISO_8859-16 . 112)
         (ISO_8859-16:2001 . 112)
         (ISO_8859-2 . 5)
         (ISO_8859-3 . 6)
         (ISO_8859-4 . 7)
         (ISO_8859-5 . 8)
         (ISO_8859-6 . 9)
         (ISO_8859-7 . 10)
         (ISO_8859-8 . 11)
         (ISO_8859-9 . 12)
         (ISO_9036 . 65)
         (ISO_TR_11548-1 . 118)
         (IT . 22)
         (JIS_C6220-1969-RO . 42)
         (JIS_C62201969RO . 42)
         (JIS_C6229-1984-B . 68)
         (JIS_C62291984B . 68)
         (JP . 42)
         (JP-OCR-B . 68)
         (JS . 87)
         (JUS_I.B1.002 . 87)
         (KOI8-E . 77)
         (KOI8-R . 2084)
         (KOI8-U . 2088)
         (KOI8R . 2084)
         (KOI8U . 2088)
         (KSC5636 . 102)
         (KZ-1048 . 119)
         (L1 . 4)
         (L10 . 112)
         (L2 . 5)
         (L3 . 6)
         (L4 . 7)
         (L5 . 12)
         (L6 . 13)
         (L8 . 110)
         (LATIN-9 . 111)
         (LATIN-GREEK . 45)
         (LATIN-GREEK-1 . 47)
         (LATIN1 . 4)
         (LATIN10 . 112)
         (LATIN2 . 5)
         (LATIN3 . 6)
         (LATIN4 . 7)
         (LATIN5 . 12)
         (LATIN6 . 13)
         (LATIN8 . 110)
         (LATINGREEK . 45)
         (LATINGREEK1 . 47)
         (MAC . 2027)
         (MACINTOSH . 2027)
         (MS936 . 113)
         (MSZ_7795.3 . 62)
         (MS_KANJI . 17)
         (NAPLPS . 74)
         (NATS-DANO . 33)
         (NATS-DANO-ADD . 34)
         (NATS-SEFI . 31)
         (NATSDANO . 33)
         (NATSSEFI . 31)
         (NC_NC00-10:81 . 92)
         (NF_Z_62-010 . 26)
         (NF_Z_62-010_1973 . 46)
         (NF_Z_62010 . 26)
         (NF_Z_62010_1973 . 46)
         (NO . 25)
         (NO2 . 58)
         (NS_4551-1 . 25)
         (NS_4551-2 . 58)
         (NS_45511 . 25)
         (NS_45512 . 58)
         (PT . 43)
         (PT154 . 2103)
         (PT2 . 60)
         (PTCP154 . 2103)
         (R8 . 2004)
         (RK1048 . 119)
         (ROMAN8 . 2004)
         (SE . 35)
         (SE2 . 21)
         (SEN_850200_B . 35)
         (SEN_850200_C . 21)
         (SHIFT-JIS . 17)
         (SHIFT_JIS . 17)
         (STRK1048-2002 . 119)
         (ST_SEV_358-88 . 94)
         (T.61 . 76)
         (T.61-8BIT . 76)
         (T.618BIT . 76)
         (TSCII . 2107)
         (UCS-4 . 1001)
         (UCS4 . 1001)
         (UK . 20)
         (UNICODE . 1000)
         (US . 3)
         (US-ASCII . 3)
         (UTF-16 . 1015)
         (UTF-16BE . 1013)
         (UTF-16LE . 1014)
         (UTF-32 . 1017)
         (UTF-32BE . 1018)
         (UTF-32LE . 1019)
         (UTF-7 . 1012)
         (UTF-8 . 106)
         (UTF16 . 1015)
         (UTF16BE . 1013)
         (UTF16LE . 1014)
         (UTF32 . 1017)
         (UTF32BE . 1018)
         (UTF32LE . 1019)
         (UTF7 . 1012)
         (UTF8 . 106)
         (VISCII . 2082)
         (WINDOWS-1250 . 2250)
         (WINDOWS-1251 . 2251)
         (WINDOWS-1252 . 2252)
         (WINDOWS-1253 . 2253)
         (WINDOWS-1254 . 2254)
         (WINDOWS-1255 . 2255)
         (WINDOWS-1256 . 2256)
         (WINDOWS-1257 . 2257)
         (WINDOWS-1258 . 2258)
         (WINDOWS-31J . 2024)
         (WINDOWS-874 . 2109)
         (WINDOWS-936 . 113)
         (YU . 87)))
		  

(define (mib->symbol m)
  (hash-ref charset-name-table m (Î» () (error 'mib->symbol "valid mib number" m))))

(define (encoding->mib e)
  (if (number? e) (encoding->mib (string-append "CP" (number->string e)))
      (hash-ref charset-value-table (string->symbol (string-upcase e)) #f)))


(define (encoding->symbol e)
  (mib->symbol (encoding->mib e)))


